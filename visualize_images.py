__author__ = 'adeb'

import os
from pylearn2.utils.string_utils import preprocess
from pylearn2.datasets import cache
import tables
import matplotlib.pyplot as plt
import numpy

path=os.path.join(
    '${PYLEARN2_DATA_PATH}', 'dogs_vs_cats', 'train.h5')
# Locally cache the files before reading them
path = preprocess(path)
dataset_cache = cache.datasetCache
path = dataset_cache.cache_file(path)
h5file = tables.openFile(path, mode="r")
node = h5file.getNode('/', 'Data')


# mis = [20631, 20698, 21859, 22285, 21191, 20520, 20845, 21125, 21063, 22323, 20425, 20953, 21924, 22223, 22234, 21899, 20159, 22376, 22256, 21030, 20568, 22365, 20959, 20317, 21885, 22049, 21078, 20480, 20106, 22446, 21155, 21651, 21559, 22252, 20716, 20292, 21877, 21000, 20071, 20327, 20287, 21566, 21536, 22349, 22488, 20044, 20282, 21667, 21469, 22411, 20334, 21882, 22020, 21663, 20260, 22070, 21716, 21482, 20511, 21246, 21730, 22374, 21222, 21301, 21586, 21560, 21978, 22271, 21394, 20858, 20918, 21349, 20725, 20602, 21299, 20623, 21348, 21488, 20149, 22186, 22475, 20194, 21617, 20569, 20436, 21917, 20817, 20853, 20550, 21104, 21136, 22050, 20608, 21550, 21602, 22303, 22107]
#
# oo = [22186, 22070, 22365, 21603, 20698, 20436, 20149, 21667, 20600, 21859, 20480, 22020, 22271, 21488, 20769, 21349, 20602, 20953, 21820, 21885, 21559, 20842, 21730, 21765, 21996, 22285, 20071, 20623, 21222, 20282, 20977, 22223, 20511, 21550, 22376, 22462, 20126, 20096, 21125, 20290, 20550, 20725, 22107, 22294, 22252, 21778, 21250, 20608, 21508, 20106, 21536, 20716, 20631, 21663, 22138, 21180, 22475, 22364, 22279, 21924, 21716, 21617, 20858, 21332, 20520, 20918, 21464, 20334, 21651, 21877, 21136, 21602, 20292, 20287, 20713, 22049, 21469, 22374, 22234, 21586, 22323, 21078, 22349, 21246, 22447, 22411, 21366, 20501, 21151, 20959, 20159, 20845, 22255, 21229, 21882, 22089, 20327]
#
# print set(mis).intersection(oo)
#
# inte = [20480, 20608, 22020, 21125, 21882, 20716, 20106, 22411, 22285, 20623, 21136, 21651, 20631, 22374, 22234, 20511, 21536, 22049, 21667, 21924, 20520, 22186, 21550, 21469, 20159, 22323, 20149, 22070, 21559, 20282, 21663, 21877, 20292, 20918, 20550, 22475, 21602, 22223, 21586, 20436, 21078, 20953, 20698, 22107, 22365, 20959, 21730, 21859, 21349, 21222, 20071, 22376, 20327, 22252, 20845, 20334, 21488, 21617, 22349, 20725, 21716, 20602, 20287, 20858, 21885, 21246, 22271]
#
# print len(inte), len(mis), len(oo)

mis = [855, 807, 1546, 598, 994, 872, 72, 165, 6]

mis = [22488, 22447, 20725, 20480, 21229, 20511, 20436, 21780, 21924, 22223, 21602, 22323, 21536, 21667, 22462, 21885, 21366, 21299, 21663, 20520, 20623, 21488, 22365, 21996, 21651, 20817, 21559, 22186, 22246, 21586, 20608, 21301, 20631, 22020, 22292, 22411, 21051, 21730, 20600, 20149, 21332, 20953, 22374, 20858, 20845, 20292, 22294, 21877, 21550, 21349, 20260, 22234, 21078, 22271, 22489, 22475, 22285, 21716, 21859, 20071, 21469, 20607, 21246, 20550, 20026, 22303, 20286, 20374, 21765, 20287, 20698, 20327, 20106, 21882, 22349, 21151, 22107, 20282, 22049, 22376, 22089, 20159, 21125]

mis = [24439, 23527, 23027, 24650, 23335, 24688, 23083, 24239, 22918, 24725, 24210, 22854, 23860, 23628, 22645, 24508, 24155, 23561, 22840, 23605, 23220, 24749, 23815, 23705, 23681, 22953, 23983, 23770, 23511, 24678, 22947, 23406, 24845, 24628, 23749, 24383, 24715, 23576, 23642, 24089, 23688, 23639, 23323, 24421, 23533, 23225, 23196, 22684, 24649, 22786, 23106, 23299, 24044, 23723, 24762, 22579, 24772, 23911, 22712, 24805, 24367, 24018, 23669, 24597, 24806, 24071, 24596, 23045, 23504]


mis = [21299, 20550, 22002, 21469, 21765, 21899, 22489, 20623, 21651, 20106, 20698, 20845, 22349, 21559, 20480, 20988, 22285, 20436, 20725, 22107, 22374, 21536, 20609, 21488, 21586, 21629, 22223, 22462, 20425, 20071, 21229, 21078, 22020, 22089, 20287, 20327, 20608, 21667, 20511, 21349, 21882, 21859, 22279, 20114, 20149, 20526, 20817, 20769, 20520, 21366, 20858, 22303, 20159, 20282, 21924, 20820, 21602, 21222, 21125, 20044, 22323, 22049, 21198, 22475, 21885, 21246, 22292, 22271, 21730, 21663, 22376, 21877, 21716]

# mis = [9999]

h5_x = getattr(node, 'X')
h5_s = getattr(node, 's')

for idx in mis:
    img = h5_x[idx]
    s = h5_s[idx]
    img = numpy.reshape(img, s)
    plt.imshow(img)
    plt.title(str(idx))
    # plt.show()
    plt.savefig("/Users/adeb/Desktop/catvsdog/" + str(idx) + ".jpeg")
